<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<title>Adivina el pueblo vasco</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body{font-family:system-ui, sans-serif; background:#f5f7fa; margin:0; padding:2rem}
  h1{color:#004d99}
  #fotos{display:grid; grid-template-columns:repeat(2,1fr); gap:1rem; margin-bottom:1.5rem}
  #fotos img{width:100%; height:200px; object-fit:cover; border-radius:8px}
  #opciones{display:grid; grid-template-columns:repeat(2,1fr); gap:1rem}
  button{padding:1rem; font-size:1.1rem; border:none; border-radius:8px; background:#0066cc; color:#fff; cursor:pointer}
  button:disabled{background:#aaa}
  #resultado{font-weight:bold; margin-top:1rem}
  #puntos{font-size:1.2rem; margin-bottom:1rem}
</style>
</head>
<body>

<h1>¿De qué pueblo vasco son estas fotos?</h1>
<div id="puntos">Puntos: <span id="score">0</span> / <span id="ronda">0</span></div>

<div id="fotos"></div>
<div id="opciones"></div>
<div id="resultado"></div>

<script>
/* 1. Base de datos de pueblos */
const pueblos = [
  "Bilbao", "Donostia", "Gernika", "Getxo", "Bermeo",
  "Lekeitio", "Ondarroa", "Zumaia", "Zarautz", "Hondarribia",
  "Vitoria-Gasteiz", "Durango", "Eibar", "Irun", "Tolosa",
  "Pasaia", "Errenteria", "Arrasate", "Sestao", "Portugalete"
];

/* 2. Variables de juego */
let correcto = "";
let ronda = 0;
let score = 0;
const TOTAL = 10;

/* 3. Funciones auxiliares */
const $ = id => document.getElementById(id);

function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}

async function cargarFotos(pueblo){
  const res = await fetch(`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=66284ebe8babaaa93c1b4f6d0e1ab539&text=${encodeURIComponent(pueblo + " pueblo")}&sort=relevance&per_page=4&format=json&nojsoncallback=1`);
  const data = await res.json();
  const fotos = data.photos.photo;
  const cont = $("fotos"); cont.innerHTML = "";
  fotos.forEach(p=>{
    const url = `https://live.staticflickr.com/${p.server}/${p.id}_${p.secret}_m.jpg`;
    cont.innerHTML += `<img src="${url}" alt="${p.title}" />`;
  });
}

function generarOpciones(respuesta){
  const opciones = [respuesta];
  while(opciones.length<4){
    const azar = pueblos[Math.floor(Math.random()*pueblos.length)];
    if(!opciones.includes(azar)) opciones.push(azar);
  }
  shuffle(opciones);
  const cont = $("opciones"); cont.innerHTML = "";
  opciones.forEach(o=>{
    const btn = document.createElement("button");
    btn.textContent = o;
    btn.onclick = ()=>comprobar(o);
    cont.appendChild(btn);
  });
}

function comprobar(respuesta){
  const btns = document.querySelectorAll("button");
  btns.forEach(b=>b.disabled=true);
  const ok = respuesta === correcto;
  if(ok){score++; $("score").textContent=score;}
  $("resultado").textContent = ok ? "¡Correcto!" : `Incorrecto. Era ${correcto}`;
  setTimeout(siguienteRonda, 1500);
}

async function siguienteRonda(){
  ronda++;
  $("ronda").textContent=ronda;
  if(ronda>TOTAL){
    $("fotos").innerHTML="";
    $("opciones").innerHTML="";
    $("resultado").innerHTML=`<h2>¡Juego terminado!</h2><p>Tu puntuación: ${score} / ${TOTAL}</p>`;
    return;
  }
  correcto = pueblos[Math.floor(Math.random()*pueblos.length)];
  await cargarFotos(correcto);
  generarOpciones(correcto);
  $("resultado").textContent="";
}

/* 4. Arrancar */
siguienteRonda();
</script>
</body>
</html>
